Title: Topic Modeling Fake News
Date: 2018-06-26
Tags: nlp topic_modeling kaggle sklearn
Slug: fake-news

I decided to change things up a little bit and take on an unsupervised learning task: topic modeling.  For this, I explored an endlessly entertaining dataset, [a database of fake news articles](https://www.kaggle.com/mrisdal/fake-news/data) compiled by Kaggle.  It is comprised of ~13K different articles from 200 different sources circa Oct'16 - Nov'16 (a period which coincided with the 2016 US Presidential Election).

First, I set up a pipeline to express each article as a bag-of-words.  I included a few preprocessing steps to clean the data (lowercase, remove URLs, remove HTML tags, and detect common phrases).  I also used TF-IDF (term frequency - inverse document frequency) to assign higher weights to more "important" words.  For the topic model itself, I used non-negative matrix factorization (NMF).  Other popular approaches include probabilistic models like LDA.

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="761px" height="159px" version="1.1" style="display:block; margin-left:auto; margin-right:auto; margin-top:20px; margin-bottom:20px;" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/66.0.3359.181 Chrome/66.0.3359.181 Safari/537.36&quot; version=&quot;8.8.7&quot; editor=&quot;www.draw.io&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;4e6f9650-b1a2-c190-d869-e8046708653f&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><rect x="120" y="0" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(126.5,9.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="106" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 108px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Lowercase<br />Remove links<br />Remove HTML tags<br /></div></div></foreignObject><text x="53" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="260" y="0" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(295.5,23.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Tokenize</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Tokenize</text></switch></g><rect x="400" y="0" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(438.5,23.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="42" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 44px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Phraser</div></div></foreignObject><text x="21" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Phraser</text></switch></g><rect x="120" y="90" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(133.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="92" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 94px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Filter Stop Words</div></div></foreignObject><text x="46" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Filter Stop Words</text></switch></g><rect x="260" y="90" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(261.5,99.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Min/Max Term Filtering + Vectorization</div></div></foreignObject><text x="58" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Min/Max Term Filtering + Vectorization</text></switch></g><rect x="640" y="90" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(686.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 27px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">NMF</div></div></foreignObject><text x="13" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">NMF</text></switch></g><rect x="400" y="90" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(440.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="38" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 39px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">TF-IDF</div></div></foreignObject><text x="19" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">TF-IDF</text></switch></g><path d="M 80 30 L 113.63 30" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 118.88 30 L 111.88 33.5 L 113.63 30 L 111.88 26.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><image x="19.5" y="-0.5" width="60" height="60" xlink:href="data:image/png;base64,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" preserveAspectRatio="none" pointer-events="none"/><image x="549.5" y="89.5" width="60" height="60" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAA+ZJREFUeJzt3TFuK1UYhuFvHBc0FNQUSFQsIVJWQE1xF0CHoKFkC+wAsYAgeSOsgO7eK6CmQqKJPRRWhIVmvtvNceLnkcbFnOa3dV7NyTRJkinJ10l+S3JKMrtcN379nuS7JNNzHD8H+L9vp5yfHF+MngSu0Nsp52PVNHoSuEZTzmcuYMFu9ABwzfYfWP9lkylgrDcr94/J+quux01Gg/EOWW7gyRELCoFAIRAoBAKFQKAQCBQCgUIgUAgECoFAIRAoBAKFQKAQCBQCgUIgUAgECoFAIRAoBAKFQKAQCBQCgUIgUAgECoFAIRAoBAKFQKAQCBQCgUIgUAgECoFAIRAo2r+B/jPJrxvOMso+yedJPknyT5K3Sf4eOtE4H+f8W3yU5K8k75I8DZ1oG/dJPl24f/R/0mHdyREL1k2eIFB4gkAhEFh32pfFOclpq0kG2eX8Jm/JcctBrsDdyv1b3gfz88fS9bjVdAMdsvzdb+HV5qV97IPFfeCIBYVAoBAIFAKBQiBQCAQKgUAhECgEAoVAoBAIFAKBQiBQCAQKgUAhECgEAoVAoBAIFAKBQiBQCAQKgUAhECgEAoVAoBAIFAKBQiBQCAQKgUAhECgEAoVAoBAIFAKBQiBQCAQKgUAhECgEAoVAoNiXtYckh60GGeR+5f4ur/+7X5rK2i3vg0xJ5g0HgZfk5IgF6yZPECg8QaAQCKw7tbdYc5LTVpMMssv6G5zjloNcgbuV+7e8D+bnj6XrcavpBjpk+bs/jRxqgH3sg8V94IgFhUCgEAgUAoFCIFAIBAqBQCEQKAQChUCgEAgUAoFCIFAIBAqBQCEQKAQChUCgEAgUAoFCIFAIBAqBQCEQKAQChUCgEAgUAoFCIFAIBAqBQCEQKAQChUCgEAgUAoFCIFAIBAqBQCEQKAQChUCg2Je1hySHrQYZ5H7l/i6v/7tfmsraLe+DTEnmDQeBl+TkiAXrJk8QKDxBoBAIrDu1t1hzktNWkwyyy/obnOOWg1yBu5X7t7wP5uePpetxq+kGOmT5uz+NHGqAfeyDxX3giAWFQKAQCBQCgUIgUAgECoFAIRAoBAKFQKAQCBQCgUIgUAgECoFAIRAoBAKFQKAQCBQCgUIgUAgECoFAIRAoBAKFQKAQCBQCgUIgUAgECoFAIRAoBAKFQKAQCBQCgUIgUAgECoFAIRAoBAKFQKDYl7U3H1h/De5X7u+SHLYcZLCprD3k9f8WX60tTEnmDQeBl+ToiAWFQKDYJflj9BBwpd7fJXlK8uXoSeAK/TDl/If6N0m+T/LZ2HmGmC6uJDnldl9cTPnv2D1fXLfmfZIfk/z0L728Z1GP1y47AAAAAElFTkSuQmCC" preserveAspectRatio="none" pointer-events="none"/><path d="M 240 30 L 253.63 30" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 258.88 30 L 251.88 33.5 L 253.63 30 L 251.88 26.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 380 33 L 393.64 32.49" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 32.29 L 392.02 36.05 L 393.64 32.49 L 391.76 29.06 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 380 120 L 393.63 120" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 120 L 391.88 123.5 L 393.63 120 L 391.88 116.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 520 120 L 543.63 120" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 548.88 120 L 541.88 123.5 L 543.63 120 L 541.88 116.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 120 L 253.63 120" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 258.88 120 L 251.88 123.5 L 253.63 120 L 251.88 116.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 460 60 L 460 67.5 Q 460 75 450 75 L 190 75 Q 180 75 180 79.32 L 180 83.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 180 88.88 L 176.5 81.88 L 180 83.63 L 183.5 81.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 610 120 L 633.63 120" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 638.88 120 L 631.88 123.5 L 633.63 120 L 631.88 116.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 730 150 L 730 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 730 150 L 730 150 L 730 150 L 730 150 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(5.5,65.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="88" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Corpus of <br />Raw Documents</div></div></foreignObject><text x="44" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Corpus of &lt;br&gt;Raw Documents</text></switch></g><g transform="translate(537.5,57.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="85" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Document Term<br />Matrix<br /></div></div></foreignObject><text x="43" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Document Term&lt;br&gt;Matrix&lt;br&gt;</text></switch></g></g></svg>

Whether using NMF or LDA, determining the number of topics to model is always a challenge.  If topics are too big, our topics will be unspecific and too broad.  If topics are too small, our topics will be overly descriptive and too narrow.  We can build models with different numbers of topics, but how do we evaluate model performance?  Two options:

1. **Topic Cohesiveness** - The extent to which a topic’s top keywords are semantically related in our overall corpus.  We can use word embeddings created with Word2Vec to measure the similarity between keywords.  Higher = better.
2. **Topic Generality** - The extent to which each topic's top keywords overlap with other topics' top keywords.  We can use mean pairwise Jaccard similarity between topics for this.  Lower = better.

Source: D. O’Callaghan, D. Greene, J. Carthy, and P. Cunningham, “An Analysis of the Coherence of Descriptors in Topic Modeling,” Expert Systems with Applications (ESWA), 2015. [[link](http://derekgreene.com/papers/ocallaghan15eswa.pdf)]

<img src="{filename}images/cohesiveness-generality.png" width="885px" style="display:block; margin-left:auto; margin-right:auto;">

I selected a number of topics that balanced these two measures (n=40).  The below chart summarizes the frequency and top keywords for each topic in the final model.  Overall, I found the topics to be highly cohesive and relevant!

<img src="{filename}images/topic-tornado.png" width="885px" style="display:block; margin-left:auto; margin-right:auto;">

Note: I found that my solutions were highly sensitive to NMF regularization.  When using an L1 regularization, I had one very large topic and a long tail of small topics.  I had a similar problem to a lesser degree when using L2 regularization.  In the end, I chose to use no regularization because I was okay with articles belonging to multiple topics.

Link to my GH repo [here](https://github.com/donaldrauscher/fake-news).  You can also play around with the model itself on [Binder](mybinder.org), a free-to-use (!) deployment of [BinderHub](https://github.com/jupyterhub/binderhub).

[![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/donaldrauscher/fake-news/master?filepath=topic_model.ipynb)
